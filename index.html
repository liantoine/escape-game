<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>ALERTE - Désamorçage en cours</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        body { 
            background: #1a0505; 
            color: #ff4d4d; 
            font-family: 'Courier New', monospace; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0;
            overflow: hidden;
        }
        
        @keyframes alert-bg {
            0% { background: #1a0505; }
            50% { background: #2d0a0a; }
            100% { background: #1a0505; }
        }
        body { animation: alert-bg 2s infinite; }

        #terminal { 
            border: 3px solid #ff0000; 
            padding: 30px; 
            background: #000; 
            box-shadow: 0 0 30px #ff0000; 
            width: 90%; 
            max-width: 550px; 
            text-align: center;
        }

        /* Style pour le rendu des matrices */
        .matrix {
            display: inline-flex;
            align-items: center;
            position: relative;
            margin: 10px;
            font-size: 1.2em;
            vertical-align: middle;
        }
        .matrix:before, .matrix:after {
            content: "";
            position: absolute;
            top: 0;
            bottom: 0;
            width: 10px;
            border: 2px solid #ff4d4d;
        }
        .matrix:before { left: -5px; border-right: 0; border-radius: 10px 0 0 10px; }
        .matrix:after { right: -5px; border-left: 0; border-radius: 0 10px 10px 0; }
        
        .matrix-content {
            display: grid;
            grid-template-columns: repeat(2, auto);
            gap: 10px 20px;
            padding: 5px 10px;
        }

        #timer-display {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
            visibility: hidden; /* Caché par défaut */
        }

        input { 
            background: #220000; 
            border: 1px solid #ff0000; 
            color: #ff0000; 
            padding: 15px; 
            width: 100%; 
            box-sizing: border-box; 
            margin-top: 20px; 
            font-size: 1.2em;
            outline: none;
        }

        button { 
            background: #ff0000; 
            color: #000; 
            border: none; 
            padding: 15px; 
            width: 100%; 
            margin-top: 15px; 
            cursor: pointer; 
            font-weight: bold; 
            font-size: 1em;
        }

        #msg { margin-top: 20px; font-weight: bold; min-height: 1.2em; }
    </style>
</head>
<body>
    <div id="terminal">
        <div id="timer-display">TEMPS : 10s</div>
        <h2 id="title">> UNITÉ DE CONTRÔLE</h2>
        <div id="instruction-box">
            <p>Énigme 1 : Calculez le déterminant de la matrice :</p>
            <div class="matrix">
                <div class="matrix-content">
                    <span>2</span><span>5</span>
                    <span>1</span><span>3</span>
                </div>
            </div>
        </div>
        
        <input type="text" id="code" placeholder="Entrez le code..." autocomplete="off">
        <button id="validate-btn" onclick="check()">VALIDER LE CODE</button>
        
        <p id="msg"></p>
    </div>

    <script>
        let etapeActuelle = 1;
        let tempsRestant = 10;
        let intervalleTimer;

        const reponses = {
            1: "6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b", // 1
            2: "4a44dc15364204a80fe80e9039455cc1608281820fe2b24f1e5233ade6af1dd5"  // 10
        };

        function check() {
            const input = document.getElementById("code").value.trim();
            const hash = CryptoJS.SHA256(input).toString();
            
            if (etapeActuelle === 1) {
                if (hash === reponses[1]) {
                    success("CODE 1 ACCEPTÉ. Accès au niveau 2...");
                    setTimeout(chargerEtape2, 1200);
                } else { error("ERREUR : Code invalide."); }
            } else {
                if (hash === reponses[2]) {
                    clearInterval(intervalleTimer);
                    finalWin();
                } else { error("ERREUR : Code invalide."); }
            }
        }

        function chargerEtape2() {
            etapeActuelle = 2;
            document.getElementById("title").innerText = "> VÉRIFICATION NIVEAU 2";
            
            // Mise à jour de l'affichage de la matrice 2
            document.getElementById("instruction-box").innerHTML = `
                <p>Énigme 2 : Calculez le déterminant de la matrice :</p>
                <div class="matrix">
                    <div class="matrix-content">
                        <span>4</span><span>2</span>
                        <span>1</span><span>3</span>
                    </div>
                </div>
            `;
            
            document.getElementById("code").value = "";
            document.getElementById("msg").innerText = "";
            document.getElementById("terminal").style.borderColor = "#ff0000";
            
            // Lancement du Timer
            const timerDisplay = document.getElementById("timer-display");
            timerDisplay.style.visibility = "visible";
            
            intervalleTimer = setInterval(() => {
                tempsRestant--;
                timerDisplay.innerText = `TEMPS : ${tempsRestant}s`;
                
                if (tempsRestant <= 0) {
                    clearInterval(intervalleTimer);
                    echecMission();
                }
            }, 1000);
        }

        function echecMission() {
            document.getElementById("validate-btn").disabled = true;
            document.getElementById("code").disabled = true;
            document.getElementById("msg").innerText = "TEMPS ÉCOULÉ : Vous avez raté l'indice !";
            document.getElementById("msg").style.color = "#ff0000";
            document.getElementById("terminal").style.borderColor = "#550000";
        }

        function success(texte) {
            document.getElementById("msg").innerText = texte;
            document.getElementById("msg").style.color = "#00ff00";
            document.getElementById("terminal").style.borderColor = "#00ff00";
        }

        function error(texte) {
            document.getElementById("msg").innerText = texte;
            document.getElementById("msg").style.color = "#ff0000";
            document.getElementById("terminal").style.borderColor = "red";
        }

        function finalWin() {
            document.getElementById("timer-display").style.visibility = "hidden";
            document.getElementById("terminal").innerHTML = `
                <h2 style='color:#00ff00'>BOMBE DÉSAMORCÉE</h2>
                <p>Le système a été stabilisé avec succès.</p>
            `;
            document.body.style.animation = "none";
            document.body.style.background = "#001a00";
        }
    </script>
</body>
</html>